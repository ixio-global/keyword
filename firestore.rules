rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // 키워드 컬렉션 - 인증된 사용자만 읽기, 관리자만 쓰기
    match /keywords/{keywordId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.token.admin == true;
    }
    
    // 매체 컬렉션 - 인증된 사용자만 읽기, 관리자만 쓰기
    match /sources/{sourceId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null && request.auth.token.admin == true;
    }
    
    // 데이터 컬렉션 - 인증된 사용자만 읽기, 시스템만 쓰기
    match /data/{dataId} {
      allow read: if request.auth != null;
      allow write: if false; // Functions에서만 쓰기 가능
    }
    
    // 알림 설정 - 관리자만 읽기/쓰기
    match /settings/{settingId} {
      allow read, write: if request.auth != null && request.auth.token.admin == true;
    }
  }
}
