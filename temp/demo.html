<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="í‚¤ì›Œë“œ íŠ¸ë Œë“œ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ - ë°ëª¨ ë²„ì „">
    <title>í‚¤ì›Œë“œ íŠ¸ë Œë“œ ëª¨ë‹ˆí„°ë§ | ë°ëª¨ ëŒ€ì‹œë³´ë“œ</title>

    <!-- ìŠ¤íƒ€ì¼ì‹œíŠ¸ -->
    <link rel="stylesheet" href="css/style.css">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>

<body>

    <!-- ë°ëª¨ ëª¨ë“œ ë°°ë„ˆ -->
    <div
        style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px; text-align: center; font-weight: 600;">
        ğŸ¨ ë°ëª¨ ëª¨ë“œ | Firebase ì—°ê²° ì—†ì´ UIë¥¼ ë¯¸ë¦¬ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤
    </div>

    <!-- í—¤ë” -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">í‚¤ì›Œë“œ íŠ¸ë Œë“œ ëª¨ë‹ˆí„°ë§</h1>
                <nav class="nav">
                    <a href="demo.html" class="nav-link active">ë°ëª¨ ëŒ€ì‹œë³´ë“œ</a>
                    <a href="index.html" class="nav-link">ë¼ì´ë¸Œ ëŒ€ì‹œë³´ë“œ</a>
                    <a href="admin.html" class="nav-link">ê´€ë¦¬ì</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="container">

        <!-- í†µê³„ ìš”ì•½ -->
        <section class="mb-xl">
            <h2 class="mb-md">ì‹¤ì‹œê°„ í†µê³„</h2>
            <div class="grid grid-4">
                <div class="stat-card">
                    <div class="stat-value" id="total-mentions">0</div>
                    <div class="stat-label">ì´ ì–¸ê¸‰ëŸ‰</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="active-keywords">0</div>
                    <div class="stat-label">í™œì„± í‚¤ì›Œë“œ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="active-sources">0</div>
                    <div class="stat-label">ëª¨ë‹ˆí„°ë§ ë§¤ì²´</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="last-update">-</div>
                    <div class="stat-label">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸</div>
                </div>
            </div>
        </section>

        <!-- í‚¤ì›Œë“œ í•„í„° -->
        <section class="mb-lg">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">í•„í„°</h3>
                </div>
                <div class="card-body">
                    <div class="grid grid-3">
                        <div class="form-group">
                            <label class="form-label" for="keyword-filter">í‚¤ì›Œë“œ</label>
                            <select class="form-select" id="keyword-filter">
                                <option value="">ì „ì²´</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="source-filter">ë§¤ì²´</label>
                            <select class="form-select" id="source-filter">
                                <option value="">ì „ì²´</option>
                                <option value="news">ë‰´ìŠ¤</option>
                                <option value="community">ì»¤ë®¤ë‹ˆí‹°</option>
                                <option value="youtube">ìœ íŠœë¸Œ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="time-filter">ê¸°ê°„</label>
                            <select class="form-select" id="time-filter">
                                <option value="24h">ìµœê·¼ 24ì‹œê°„</option>
                                <option value="7d">ìµœê·¼ 7ì¼</option>
                                <option value="30d">ìµœê·¼ 30ì¼</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- íŠ¸ë Œë“œ ê·¸ë˜í”„ -->
        <section class="mb-xl">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">í‚¤ì›Œë“œ íŠ¸ë Œë“œ ì¶”ì´</h3>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="trend-chart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- ê¸‰ì¦ ì•Œë¦¼ -->
        <section class="mb-xl" id="alerts-section">
            <h2 class="mb-md">ğŸ”” íŠ¸ë Œë“œ ê¸‰ì¦ ì•Œë¦¼</h2>
            <div id="alerts-container"></div>
        </section>

        <!-- ë°ì´í„° í…Œì´ë¸” -->
        <section class="mb-xl">
            <div class="card">
                <div class="card-header d-flex justify-between align-center">
                    <h3 class="card-title">ìˆ˜ì§‘ ë°ì´í„°</h3>
                    <button class="btn btn-outline" id="refresh-btn">
                        <span id="refresh-icon">ìƒˆë¡œê³ ì¹¨</span>
                    </button>
                </div>
                <div class="card-body">
                    <div class="table-container">
                        <table class="table" id="data-table">
                            <thead>
                                <tr>
                                    <th>ë§¤ì²´</th>
                                    <th>í‚¤ì›Œë“œ</th>
                                    <th>ì œëª©</th>
                                    <th>ë§í¬</th>
                                    <th>ìˆ˜ì§‘ ì‹œê°„</th>
                                </tr>
                            </thead>
                            <tbody id="data-table-body">
                                <tr>
                                    <td colspan="5" class="text-center text-muted">ë°ëª¨ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                    <div class="d-flex justify-between align-center mt-md">
                        <div class="text-muted" id="pagination-info">0ê°œì˜ ê²°ê³¼</div>
                        <div class="d-flex gap-sm" id="pagination-controls">
                            <button class="btn btn-outline" id="prev-page" disabled>ì´ì „</button>
                            <button class="btn btn-outline" id="next-page" disabled>ë‹¤ìŒ</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- ë°ëª¨ ë°ì´í„° ë° ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="js/demo-data.js"></script>
    <script>
        // ë°ëª¨ ë°ì´í„° ë¡œë“œ
        const demoData = generateDemoData(100);
        const trendData = generateTrendData();
        const stats = generateStats(demoData);
        const alerts = generateAlerts();

        // í†µê³„ í‘œì‹œ
        document.getElementById('total-mentions').textContent = stats.totalMentions;
        document.getElementById('active-keywords').textContent = stats.activeKeywords;
        document.getElementById('active-sources').textContent = stats.activeSources;
        document.getElementById('last-update').textContent = stats.lastUpdate;

        // í‚¤ì›Œë“œ í•„í„° ì˜µì…˜ ì¶”ê°€
        const keywordFilter = document.getElementById('keyword-filter');
        demoKeywords.forEach(keyword => {
            if (keyword.active) {
                const option = document.createElement('option');
                option.value = keyword.id;
                option.textContent = keyword.name;
                keywordFilter.appendChild(option);
            }
        });

        // ì°¨íŠ¸ ìƒì„±
        const ctx = document.getElementById('trend-chart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: trendData.labels,
                datasets: Object.keys(trendData.datasets).map((keyword, index) => {
                    const colors = ['#667eea', '#f093fb', '#4facfe', '#ffd89b', '#a8edea'];
                    return {
                        label: keyword,
                        data: trendData.datasets[keyword],
                        borderColor: colors[index % colors.length],
                        backgroundColor: colors[index % colors.length] + '20',
                        tension: 0.4,
                        fill: true
                    };
                })
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // ì•Œë¦¼ í‘œì‹œ
        const alertsContainer = document.getElementById('alerts-container');
        alerts.forEach(alert => {
            const alertCard = document.createElement('div');
            alertCard.className = 'card mb-md';
            alertCard.style.borderLeft = '4px solid #f093fb';
            alertCard.innerHTML = `
        <div class="card-body">
          <h4 style="margin-bottom: 12px;">ğŸ“ˆ ${alert.keyword}</h4>
          <p style="color: var(--text-muted); margin-bottom: 8px;">
            ì „ ì£¼ê¸° ëŒ€ë¹„ <strong style="color: #f093fb;">${alert.percentageChange}% ìƒìŠ¹</strong>
          </p>
          <p style="color: var(--text-muted); font-size: 0.9rem;">
            ì´ì „: ${alert.previousCount}ê±´ â†’ í˜„ì¬: ${alert.recentCount}ê±´
          </p>
          <p style="color: var(--text-muted); font-size: 0.9rem;">
            ì£¼ìš” ë§¤ì²´: ${alert.sources}
          </p>
        </div>
      `;
            alertsContainer.appendChild(alertCard);
        });

        // í…Œì´ë¸” ë°ì´í„° í‘œì‹œ
        let currentPage = 0;
        const itemsPerPage = 20;
        let filteredData = [...demoData];

        function renderTable() {
            const tbody = document.getElementById('data-table-body');
            tbody.innerHTML = '';

            const start = currentPage * itemsPerPage;
            const end = start + itemsPerPage;
            const pageData = filteredData.slice(start, end);

            if (pageData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center text-muted">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</td></tr>';
                return;
            }

            pageData.forEach(item => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
          <td>${item.source}</td>
          <td><span class="badge">${item.keyword}</span></td>
          <td>${item.title}</td>
          <td><a href="${item.url}" target="_blank" class="link">ë³´ê¸°</a></td>
          <td>${new Date(item.timestamp).toLocaleString('ko-KR')}</td>
        `;
                tbody.appendChild(tr);
            });

            // í˜ì´ì§€ë„¤ì´ì…˜ ì •ë³´
            document.getElementById('pagination-info').textContent =
                `${filteredData.length}ê°œì˜ ê²°ê³¼ (${start + 1}-${Math.min(end, filteredData.length)})`;

            // í˜ì´ì§€ë„¤ì´ì…˜ ë²„íŠ¼
            document.getElementById('prev-page').disabled = currentPage === 0;
            document.getElementById('next-page').disabled = end >= filteredData.length;
        }

        // í•„í„° ì ìš©
        function applyFilters() {
            const keyword = keywordFilter.value;
            const source = document.getElementById('source-filter').value;

            filteredData = demoData.filter(item => {
                if (keyword && item.keywordId !== keyword) return false;
                if (source && item.sourceType !== source) return false;
                return true;
            });

            currentPage = 0;
            renderTable();
        }

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        keywordFilter.addEventListener('change', applyFilters);
        document.getElementById('source-filter').addEventListener('change', applyFilters);
        document.getElementById('refresh-btn').addEventListener('click', () => {
            location.reload();
        });
        document.getElementById('prev-page').addEventListener('click', () => {
            if (currentPage > 0) {
                currentPage--;
                renderTable();
            }
        });
        document.getElementById('next-page').addEventListener('click', () => {
            if ((currentPage + 1) * itemsPerPage < filteredData.length) {
                currentPage++;
                renderTable();
            }
        });

        // ì´ˆê¸° ë Œë”ë§
        renderTable();
    </script>

</body>

</html>